---
title: chernobyl-cesium-137
author: Philippe Massicotte
date: '2019-07-28'
slug: chernobyl-cesium-137
categories:
  - R
tags:
  - Chernobyl
type: ''
subtitle: ''
image: ''
draft: true
---



<pre class="r"><code>df &lt;-
  readxl::read_excel(
    &quot;c:/Users/pmass/Downloads/CHERNAIR.xls&quot;,
    na = c(&quot;&lt;&quot;, &quot;&quot;, &quot;N&quot;, &quot;L&quot;)
  ) %&gt;%
  janitor::clean_names() %&gt;%
  mutate(date = lubridate::ymd(date)) %&gt;%
  mutate(date_time = make_datetime(
    year(date),
    month(date),
    day(date),
    hour(end_of_sampling),
    minute(end_of_sampling),
    second(end_of_sampling)
  ))</code></pre>
<div id="map" class="section level2">
<h2>Map</h2>
<pre class="r"><code>world &lt;- ne_countries(scale = &quot;medium&quot;, returnclass = &quot;sf&quot;)

df2 &lt;- df %&gt;%
  count(pays, ville, x, y) %&gt;%
  st_as_sf(
    coords = c(&quot;x&quot;, &quot;y&quot;),
    crs = &quot;+proj=longlat +datum=WGS84&quot;
  ) %&gt;% 
  st_transform(st_crs(world))

world_points &lt;- cbind(world, st_coordinates(st_centroid(world$geometry)))
#&gt; Warning in st_centroid.sfc(world$geometry): st_centroid does not give
#&gt; correct centroids for longitude/latitude data


world %&gt;%
  ggplot() +
  geom_sf(size = 0.3) +
  geom_text(data= world_points,aes(x=X, y=Y, label=name), check_overlap = TRUE, size = 2) +
  geom_sf(
    data = df2,
    aes(size = n),
    show.legend = &quot;point&quot;,
    stroke = 0.1,
    fill = &quot;red&quot;,
    color = &quot;black&quot;,
    shape = 21
  ) +
  coord_sf(xlim = st_bbox(df2)[c(1, 3)], ylim = st_bbox(df2)[c(2, 4)]) +
  scale_size_continuous(range = c(0.5, 5)) +
  labs(subtitle = str_wrap(&quot;Geolocalisations of the measurements&quot;, 100)) +
  labs(title = &quot;Map of the data&quot;) </code></pre>
<p><img src="/post/2019-07-28-chernobyl-cesium-137.en_files/figure-html/unnamed-chunk-2-1.svg" width="2400" style="display: block; margin: auto;" /></p>
<pre class="r"><code>
df %&gt;%
  drop_na(cs_137_bq_m3) %&gt;%
  group_by(ville) %&gt;%
  filter(cs_137_bq_m3 == max(cs_137_bq_m3)) %&gt;%
  ungroup() %&gt;%
  top_n(16, cs_137_bq_m3) %&gt;%
  mutate(ville = glue(&quot;{str_to_title(ville)} ({pays})&quot;)) %&gt;%
  mutate(ville = fct_reorder(ville, cs_137_bq_m3)) %&gt;%
  ggplot(aes(x = ville, y = cs_137_bq_m3)) +
  geom_col() +
  coord_flip() +
  scale_y_continuous(expand = expand_scale(mult = c(0, 0.05))) +
  scale_x_discrete(expand = c(0, 0)) +
  geom_text(aes(label = format(round(cs_137_bq_m3, digits = 2), nsmall = 2)),
    vjust = 0.5,
    color = &quot;white&quot;,
    hjust = 1.2
  ) +
  geom_text(
    aes(label = date),
    vjust = 0.5,
    color = &quot;white&quot;,
    hjust = 0,
    size = 4,
    y = 0.3
  ) +
  theme(panel.grid.major.y = element_blank()) +
  theme(panel.grid.minor.y = element_blank()) +
  xlab(NULL) +
  labs(
    title = str_wrap(&quot;Caesium-137 in different cities after the Chernobyl incident&quot;, width = 40),
    subtitle = str_wrap(&quot;Top 16 cities and the date at which maximum caesium-137 was measured.&quot;, 60)
  ) +
  theme(axis.ticks.y = element_blank()) +
  ylab(bquote(&quot;Caesium-137 concentration in&quot; ~ Bq ~ m^{
    -3
  } ~ ~&quot;(aerosol particles)&quot;)) +
  labs(caption = &quot;Data extracted from REM data bank at CEC Joint Research Centre Ispra&quot;) +
  theme(plot.caption = element_text(colour = &quot;grey50&quot;))</code></pre>
<p><img src="/post/2019-07-28-chernobyl-cesium-137.en_files/figure-html/unnamed-chunk-3-1.svg" width="2400" style="display: block; margin: auto;" /></p>
</div>
